{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst BASE_URL = 'https://pixabay.com/api/';\nconst API_KEY = '43842953-9dbca6afb64f09675f00184b1';\n\nexport const fetchImages = async (searchValue = '', page = 1, perPage = 15) => {\n  try {\n    const response = await axios.get(\n      `${BASE_URL}?key=${API_KEY}&q=${encodeURIComponent(\n        searchValue\n      )}&image_type=photo&orientation=horizontal&safesearch=true&page=${page}&per_page=${perPage}`\n    );\n\n    return response.data;\n  } catch (error) {\n    console.error(error);\n  }\n};","export const renderImages = (blockToInsertedHtml, imagesArr = []) => {\n  const markup = imagesArr\n    .map(\n      ({\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n        webformatURL,\n        largeImageURL,\n      }) => {\n        return `\n        <li class=\"gallery-item\">\n          <a class=\"gallery-link\" href=\"${largeImageURL}\" >\n            <img class=\"gallery-image\" src=\"${webformatURL}\" alt=\"${tags}\" />\n            <ul class=\"stats-block\">\n              <li>\n                <span>Likes</span>\n                <span>${likes}</span>\n              </li>\n              <li>\n                <span>Views</span>\n                <span>${views}</span>\n              </li>\n              <li>\n                <span>Comments</span>\n                <span>${comments}</span>\n              </li>\n              <li>\n                <span>Downloads</span>\n                <span>${downloads}</span>\n              </li>\n            </ul>\n          </a>\n        </li>\n        `;\n      }\n    )\n    .join('');\n\n  blockToInsertedHtml.insertAdjacentHTML('beforeend', markup);\n};","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport { fetchImages } from './js/pixabay-api';\nimport { renderImages } from './js/render-functions';\n\nconst searchInput = document.querySelector('input[class=\"search-input\"]');\nconst form = document.querySelector('form[class=\"search\"]');\nconst gallerySection = document.querySelector(\n  'section[class=\"gallery-section\"]'\n);\nconst loaderHtml = '<div id=\"loader\" class=\"loader\"></div>';\nconst imgBlock = document.querySelector('ul[class=\"gallery\"]');\nconst loadMoreButton = document.getElementById('load-more');\nlet images = [];\nlet formInput = '';\nlet page = 1;\nlet perPage = 15;\nlet maxPages;\n\nconst lightboxOptions = {\n  captionsData: 'alt',\n  captionDelay: 250,\n};\n\nconst lightbox = new SimpleLightbox('ul.gallery a', lightboxOptions);\n\nconst toastSettings = {\n  position: 'topRight',\n  messageColor: '#ffffff',\n  timeout: 5000,\n  radius: 15,\n};\n\nconst erorrMessage = message => {\n  iziToast.error({\n    ...toastSettings,\n    backgroundColor: '#FF2E2E',\n    message,\n  });\n};\n\nconst infoMessage = message => {\n  iziToast.info({\n    ...toastSettings,\n    backgroundColor: 'lightblue',\n    message,\n  });\n};\n\nconst scrolledImages = height => {\n  const timeout = setTimeout(() => {\n    window.scrollBy({\n      top: height * 2,\n      left: 0,\n      behavior: 'smooth',\n    });\n    clearTimeout(timeout);\n  }, 1000);\n};\n\nconst loadMore = async () => {\n  try {\n    if (page <= maxPages) {\n      if (page === maxPages) {\n        infoMessage(\n          `We're sorry, but you've reached the end of search results.`\n        );\n        loadMoreButton.classList.replace('load-more', 'none');\n      }\n      gallerySection.insertAdjacentHTML('beforebegin', loaderHtml);\n      const imagesData = await fetchImages(formInput, page, perPage);\n\n      const loader = document.querySelector('#loader');\n      if (loader) {\n        loader.remove();\n      }\n      images = [...images, ...imagesData.hits];\n      renderImages(imgBlock, images);\n\n      lightbox.refresh();\n\n      page === maxPages ? (page = 1) : (page += 1);\n      const galleryItem = document.querySelector('.gallery-item');\n      const galleryItemSize = galleryItem.getBoundingClientRect();\n      scrolledImages(galleryItemSize.height);\n    }\n  } catch (error) {\n    console.error(error);\n  }\n};\n\nconst handleSubmit = async event => {\n  event.preventDefault();\n\n  images = [];\n  page = 1;\n  imgBlock.textContent = '';\n  loadMoreButton.classList.replace('load-more', 'none');\n  const form = event.target;\n  const input = searchInput.value.trim();\n  formInput = input;\n\n  if (input === '') {\n    erorrMessage('The request must not be empty!');\n    return;\n  }\n\n  try {\n    gallerySection.insertAdjacentHTML('beforebegin', loaderHtml);\n    const imagesData = await fetchImages(input, page, perPage);\n\n    const loader = document.querySelector('#loader');\n    if (loader) {\n      loader.remove();\n    }\n\n    if (imagesData !== null && imagesData.hits.length > 0) {\n      images = [...images, ...imagesData.hits];\n\n      renderImages(imgBlock, images);\n\n      lightbox.refresh();\n      maxPages = Math.ceil(imagesData.total / perPage);\n      page += 1;\n\n      if (page > 1) {\n        loadMoreButton.classList.replace('none', 'load-more');\n      }\n    } else {\n      erorrMessage(\n        'Sorry, there are no images matching your search query. Please, try again again!'\n      );\n    }\n  } catch (error) {\n    console.error('Error fetching images:', error);\n  }\n\n  form.reset();\n};\n\nform.addEventListener('submit', handleSubmit);\nloadMoreButton.addEventListener('click', loadMore);"],"names":["BASE_URL","API_KEY","fetchImages","searchValue","page","perPage","axios","error","renderImages","blockToInsertedHtml","imagesArr","markup","tags","likes","views","comments","downloads","webformatURL","largeImageURL","searchInput","form","gallerySection","loaderHtml","imgBlock","loadMoreButton","images","formInput","maxPages","lightboxOptions","lightbox","SimpleLightbox","toastSettings","erorrMessage","message","iziToast","infoMessage","scrolledImages","height","timeout","loadMore","imagesData","loader","galleryItemSize","handleSubmit","event","input"],"mappings":"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"}